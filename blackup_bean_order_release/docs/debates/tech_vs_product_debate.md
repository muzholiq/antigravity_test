# ⚔️ Tech Lead vs Product Lead — 기획안 기술 비판 & 비즈니스 방어

> **대상 문서**: `implementation_plan.md` (v3), `design_review.md`, `multi_persona_debate.md`
> **형식**: Distinguished Engineer(Tech Lead)가 기획안을 기술적으로 비판 → Principal PM(Product Lead)이 비즈니스 관점에서 방어

---

## 🏗️ Round 1: 아키텍처의 단일 실패점 (Single Point of Failure)

### 🔴 Tech Lead 비판

> **[Failure Mode Analysis: CRITICAL]**
>
> 이 설계의 가장 큰 문제는 **Antigravity 에이전트가 브라우저 도구로 Google Sheets를 순회한다는 것** 자체다.
>
> 1. **브라우저 세션 불안정**: 브라우저 도구는 네트워크 지연, 세션 만료, Google 인증 팝업, CAPTCHA 등으로 **언제든 실패할 수 있다.** 매장 10개를 순회하다 7번째에서 세션이 끊기면? 부분 데이터로 리포트를 생성하나?
> 2. **재시도 전략 부재**: 실패 시 어디서부터 재시작할지, 이미 읽은 데이터는 어떻게 처리할지 전혀 정의되어 있지 않다. **Idempotency가 보장되지 않는다.**
> 3. **SLO 미정의**: "매일 17시 이후 실행한다"고 했는데, 실패하면? 재실행 가능 시간 윈도우는? 리포트가 하루 누락되면 비즈니스 임팩트는? **SLO/SLA가 전혀 없다.**
>
> **Tech Debt Score: 8/10** — 스크립트 0개를 자랑하지만, 그 대가로 모든 안정성을 에이전트의 "즉흥 대응"에 의존하고 있다.

### 🟢 Product Lead 방어

> **[비즈니스 맥락 재환기]**
>
> Tech Lead의 지적은 **대규모 서비스 기준**에서는 정당하다. 그러나 이 시스템의 컨텍스트를 상기시켜 드리겠다:
>
> 1. **사용자 규모**: 매장 3~5개, 하루 주문 10~20건. Netflix가 아니라 **동네 로스터리의 업무 자동화**다. 99.99% SLA는 과잉 설계다.
> 2. **현재 As-Is**: 관리자가 카카오톡으로 받은 주문을 수작업으로 엑셀에 옮긴다. 이것보다 **나빠질 수가 없다.** 브라우저 세션이 1번 실패해서 재실행하는 것은, 카카오톡 메시지를 수작업으로 옮기는 것보다 여전히 10배 빠르다.
> 3. **MVP 전략**: 완벽한 시스템을 만들다 출시 못 하는 것보다, 불완전하지만 **오늘 쓸 수 있는 도구**가 비즈니스 가치가 크다. 실패 시 관리자가 수동 재실행하면 된다. Human-in-the-loop이 적절한 단계다.
>
> 단, Tech Lead의 우려를 존중하여 **SKILL.md에 "실패 시 대응 가이드"** (어떤 매장까지 처리했는지 확인 → 해당 매장부터 재시도)를 추가하겠다.
>
> **KPI 근거**: 관리자 일일 주문 정리 시간 **60분 → 10분** 절감이 핵심 성공 지표. 완벽한 안정성보다 "쓸 수 있는가"가 v1의 판단 기준이다.

---

## 🏗️ Round 2: Google Sheets 의존성과 확장성 한계

### 🔴 Tech Lead 비판

> **[System Architecture: WARNING]**
>
> Google Sheets를 "데이터베이스"로 쓰고 있다. 잠깐 멈추고 이게 무슨 의미인지 생각해보자:
>
> 1. **동시 편집 충돌**: 매장 직원 A가 수량을 수정하는 도중에 에이전트가 읽으면? **Dirty Read** 가능성이 있다.
> 2. **스키마 강제 불가**: 컬럼 순서를 바꾸거나, 행을 실수로 삭제하거나, 시트 이름을 변경하면 에이전트가 깨진다. **스키마 변경에 대한 방어가 전무**하다.
> 3. **매장 확장 한계**: 현재 3~5개 매장이지만, 10개, 20개로 늘면? 매장마다 별도 Sheets니까 `settings.yaml`에 URL을 하나하나 추가? 에이전트가 20개 Sheets를 브라우저로 순회하면 실행 시간이 선형적으로 증가한다. **O(n) 스케일링**이다.
> 4. **API 미사용의 대가**: "브라우저 기반, 별도 API 인증 불필요"를 장점으로 내세우지만, Google Sheets API를 쓰면 인증 1회 셋업으로 **안정적이고 빠른 프로그래매틱 접근**이 가능하다. 의도적으로 더 불안정한 방법을 선택한 것이다.
>
> **Tech Debt Score: 7/10** — 3개월 후 매장이 8개로 늘면 아키텍처 전면 재설계가 필요해질 수 있다.

### 🟢 Product Lead 방어

> **[User Pain Points 분석]**
>
> 핵심을 놓치고 계신다. **왜 브라우저 기반을 선택했는지**를 설명하겠다:
>
> 1. **대상 사용자 = 비개발자**: 이 시스템의 관리자는 로스터리 사장님이다. "Google Cloud Console에서 서비스 계정을 만들고 OAuth 2.0을 설정하세요"라고 하면 그 순간 프로젝트는 **사망**한다. 브라우저로 구글 계정 로그인만 하면 되는 것이 **10x Differentiation**이다.
> 2. **매장 20개 시나리오**: 한국 스페셜티 커피 로스터리의 평균 거래 매장 수는 5~15개다. 20개 이상이면 이미 중견기업이고, 그때는 ERP를 도입한다. **실존하지 않는 확장 시나리오에 오버엔지니어링하지 말자.**
> 3. **Dirty Read 리스크**: 17시 마감 후 실행 가이드가 있다. 마감 후에는 편집이 사실상 없다. 운영 규칙으로 기술적 리스크를 충분히 완화할 수 있다.
> 4. **단계적 마이그레이션 전략**: v1에서 브라우저로 시작하고, v2에서 실제 사용 패턴 데이터를 확보한 후 API 전환을 결정한다. "Data-informed architecture decision"이다.
>
> **Growth Loop 근거**: 비개발자가 **설정 5분 만에 사용 가능** → 빠른 온보딩 → 입소문 → 신규 로스터리 고객 유입. 복잡한 셋업은 이 루프를 즉사시킨다.

---

## 🏗️ Round 3: 교차검증의 한계 — 검증자도 에이전트

### 🔴 Tech Lead 비판

> **[SRE / Monitoring: CRITICAL]**
>
> 교차검증이 11개 항목이나 되는 건 좋다. **그런데 검증하는 주체가 에이전트 자신이다.**
>
> 1. **Self-validation 패러독스**: 데이터를 읽고, 집계하고, 검증하는 게 동일 에이전트다. 에이전트가 파싱 로직에서 실수하면 **같은 실수가 검증에도 전파**된다. "자기가 채점한 시험을 자기가 검증한다"는 것이다.
> 2. **검증 커버리지 의문**: 교차검증이 비정상 데이터를 "경고만" 표시한다. 차단하지 않는다. 경고를 무시하고 리포트를 사용하면? **경고 피로(Alert Fatigue)** 로 이어질 가능성이 높다.
> 3. **모니터링/로깅 전략 부재**: 에이전트 실행 기록, 오류 발생 이력, 리포트 생성 성공/실패 이력이 어디에도 저장되지 않는다. 장애 사후 분석(Post-mortem)이 불가능하다.
> 4. **원본 데이터 보존**: 에이전트가 Sheets를 읽은 시점의 스냅샷이 없다. 리포트 생성 후 매장이 Sheets를 수정하면, "원본이 뭐였는지" 추적할 수 없다.
>
> **Tech Debt Score: 6/10** — 검증 문화는 좋으나, 독립적 검증이 아닌 자기 검증은 절반의 가치만 있다.

### 🟢 Product Lead 방어

> **[Service Logic Flow 관점]**
>
> 독립 검증의 이상적 가치에는 동의한다. 그러나 **현실적 트레이드오프**를 직시하자:
>
> 1. **현재 대안과 비교**: As-Is(수작업)에서는 검증 자체가 **0%**다. 카카오톡 메시지를 엑셀에 옮기면서 합계를 대조해보는 사람이 있을까? Self-validation이라도 **0% → 80%**로 끌어올리는 것이다.
> 2. **Alert Fatigue 대응**: "경고만 표시"는 의도적 설계다. 이 시스템의 사용자는 비개발자이므로 **차단(Block)은 패닉을 유발**한다. "문제가 있을 수 있으니 확인해주세요"가 "주문이 거부되었습니다"보다 적절하다. **Accessibility & Inclusion 원칙** — 기술에 익숙하지 않은 사용자도 두려움 없이 사용할 수 있어야 한다.
> 3. **스냅샷 보존의 비용**: 매번 원본 데이터를 별도 저장하면 Google Drive 용량, 관리 복잡도가 증가한다. 3개 매장의 일일 주문 10~20건에 대해 **스냅샷 인프라를 구축하는 것은 ROI가 마이너스**다.
> 4. **실행 이력은 이미 존재**: Antigravity 에이전트의 대화 내역 자체가 실행 로그다. 언제, 어떤 Sheets를 읽었고, 어떤 리포트를 생성했는지 대화 히스토리에서 추적 가능하다.
>
> **Success Metrics**: 교차검증 오탐율(False Positive)을 모니터링하고, v2에서 검증 정확도를 개선한다. 완벽한 검증 시스템을 만들다 출시를 미루는 것은 **Ethics** 위반 — 관리자의 시간(비용)을 낭비하는 것이다.

---

## 🏗️ Round 4: settings.yaml의 비대화 — Configuration Hell

### 🔴 Tech Lead 비판

> **[Tech Debt Control: WARNING]**
>
> `settings.yaml`이 모든 것을 담고 있다. 매장 정보, 원두 목록, 재고 수량, 원가, 로스팅 프로파일 매핑, 리드타임, 원가 활성화 플래그, 리포트 종류까지.
>
> 1. **관심사 분리 위반**: 하나의 파일이 Configuration, Master Data, Business Rule을 모두 담고 있다. `min_lead_days`(비즈니스 룰)와 `sheet_url`(인프라 설정)과 `stock_kg`(런타임 데이터)가 같은 파일에? **단일 책임 원칙(SRP) 위반**이다.
> 2. **재고 데이터의 수동 관리**: `stock_kg: 30`을 수동으로 관리한다고? 주문이 15kg 나가면 관리자가 yaml 파일을 편집해서 15로 바꿔야 하나? **수동 업데이트를 잊으면 재고 경고가 무의미**해진다. 이건 기술 부채가 아니라 **설계 결함**이다.
> 3. **YAML 편집 위험**: 비개발자가 YAML을 편집한다. 들여쓰기가 틀어지면 파싱 에러. 따옴표를 빼먹으면 파싱 에러. **YAML은 사용자 친화적 포맷이 아니다.**
>
> **Tech Debt Score: 7/10** — 초기에는 편리하지만, 운영 단계에서 반드시 문제가 터진다.

### 🟢 Product Lead 방어

> **[10x Differentiation 관점]**
>
> 아키텍처적으로 옳은 말이지만, **"지금 필요한가?"** 를 따져보자:
>
> 1. **파일 1개 = 인지 부하 최소화**: 비개발자 관리자에게 `config/`, `data/`, `rules/` 3개 폴더에 분산된 설정 파일을 관리하라고 하면 혼란만 가중된다. "이 파일 하나만 관리하세요"가 **10x 단순함**이다.
> 2. **재고는 "참고용"**: implementation_plan에서 이미 "별도의 재고 관리 시스템은 scope 밖"으로 결정했다. `stock_kg`는 ERP 수준의 정밀 재고가 아니라, **대략적 가용량을 참고하는 경고 기준**이다. 매일 정확히 업데이트할 필요가 없고, 일주일에 한 번 대략 맞추면 충분하다.
> 3. **YAML 편집 위험 완화**: SKILL.md의 운영 가이드에 **YAML 편집 예시와 주의사항**을 포함한다. 또한 에이전트가 settings.yaml을 로드할 때 **기본적인 구문 검증**을 수행하도록 가이드에 명시하면, 편집 실수를 조기에 발견할 수 있다.
> 4. **SRP는 스케일에 비례**: 3개 매장, 3종 원두에 SRP를 엄격히 적용하는 것은 **Over-engineering**이다. 매장 10개, 원두 10종 이상으로 늘어날 때 분리를 검토하면 된다.
>
> **Retention Loop 근거**: 설정이 단순해야 관리자가 **"이거 편하다"**고 느끼고 계속 쓴다. 복잡해지면 다시 카카오톡으로 돌아간다.

---

## 🏗️ Round 5: 스크립트 0개 — 자랑인가, 리스크인가?

### 🔴 Tech Lead 비판

> **[Disaster Recovery: HIGH RISK]**
>
> "스크립트 0개! 모든 로직은 SKILL.md에 가이드로 작성하고 에이전트가 실행합니다." — 이 문구가 가장 위험하다.
>
> 1. **재현 불가능(Non-deterministic)**: 에이전트는 자연어 지시를 해석해서 동작한다. 같은 SKILL.md를 읽어도 에이전트 버전, 컨텍스트, 컨디션에 따라 **출력이 달라질 수 있다.** 코드는 결정적(deterministic), SKILL.md 기반 에이전트는 비결정적이다.
> 2. **디버깅 불가**: 리포트 결과가 이상할 때, 코드라면 디버깅할 수 있다. 에이전트의 "판단"은 어떻게 디버깅하는가? **블랙박스 시스템**이다.
> 3. **버전 관리 한계**: SKILL.md를 수정하면 동작이 바뀌는데, 이전 버전의 SKILL.md로 생성한 리포트와 새 버전의 차이를 추적할 방법이 없다.
> 4. **DR(재해 복구)**: Antigravity 서비스에 장애가 나면? 에이전트가 없으면 **수동 집계밖에 방법이 없다.** 백업 스크립트라도 있으면 다른 환경에서 실행 가능하지만, SKILL.md만으로는 불가능하다.
>
> **Tech Debt Score: 9/10** — 단일 에이전트 서비스에 대한 완전한 종속(Vendor Lock-in). **Green Computing 관점**에서도 브라우저 렌더링을 통한 Sheets 접근은 API 대비 수십 배의 컴퓨팅 자원을 낭비한다.

### 🟢 Product Lead 방어

> **[Core UX / Why & Who 관점]**
>
> 가장 본질적인 질문으로 돌아가겠다: **"이 시스템은 누구를 위한 것인가?"**
>
> 1. **대상: 개발자가 아닌 로스터리 관리자**: 스크립트가 있으면 "Python 설치하세요", "pip install하세요", "API 키 설정하세요" → **사용 포기**. 스크립트 0개는 자랑이 아니라 **핵심 가치 제안(Value Proposition)**이다.
> 2. **비결정성의 장점**: 에이전트가 유연하게 대응하는 것이 오히려 강점이다. 시트 데이터가 약간 다른 형식이어도, 에이전트는 맥락을 파악해서 처리할 수 있다. 스크립트는 `ValueError`를 뱉고 멈춘다.
> 3. **Vendor Lock-in에 대한 현실적 평가**: 이미 Google Sheets에 종속되어 있다. Antigravity에 종속이 추가되는 것은 사실이나, **"종속 없는 시스템"은 존재하지 않는다.** 중요한 것은 "탈출 비용"이 감당 가능한 수준인지다. 데이터는 Google Sheets에 원본이 있고, 리포트는 Markdown이다. Antigravity를 떠나도 데이터는 100% 보존된다.
> 4. **DR 현실성**: Antigravity 장애 시? **관리자가 직접 Sheets를 열고 수동 집계한다.** 이것이 시스템 도입 전의 원래 업무 방식이다. DR이 "원래 방식으로 돌아가기"인 시스템은 DR 리스크가 낮다.
>
> **Ethics & Privacy**: 스크립트 기반은 사용자의 구글 계정 API 키를 코드에 보관해야 한다. 브라우저 기반은 **일반 로그인** → 키 노출 위험 제로. 보안 관점에서도 현 설계가 우월하다.

---

## 🏗️ Round 6: 에러 메시지 UX — 기술 용어 vs 사람 말

### 🔴 Tech Lead 비판

> **[System Architecture: MODERATE]**
>
> 교차검증에서 경고가 발생하면 리포트에 `⚠️ 납기 촉박`, `🟡 미등록 원두` 같은 표시를 한다. 그런데 **구체적인 조치 안내가 없다.**
>
> 1. **경고 후 What's Next?**: "납기 촉박"이라고만 쓰면 관리자는 **어떻게 해야 하는지 모른다.** 해당 매장에 연락해서 배송일을 조율해야 하는지, 주문을 무시해야 하는지, 긴급 로스팅을 시작해야 하는지?
> 2. **경고 심각도 구분 부재**: 11개 검증 항목이 모두 같은 `⚠️`로 표시된다. "수량이 음수"(100% 오류)와 "납기 촉박"(판단 필요)은 **심각도가 완전히 다른데** 동일하게 처리된다.
> 3. **Actionable Alert의 부재**: SRE 원칙에서 경고는 반드시 **Action Item**을 동반해야 한다. Action 없는 경고는 곧 무시된다.
>
> **Tech Debt Score: 5/10** — 경고 체계의 완성도 문제.

### 🟢 Product Lead 방어

> **[User Pain Points / Accessibility]**
>
> 전적으로 동의한다. 이건 비판이 아니라 **개선 제안**이다.
>
> 1. **경고 3단계 분류 수용**: `❌ CRITICAL` (데이터 오류, 즉시 확인) / `⚠️ WARNING` (판단 필요) / `ℹ️ INFO` (참고)
> 2. **각 경고에 권장 조치(Suggested Action) 추가**: 예) "⚠️ 납기 촉박: 강남점 COL-SUP → 매장에 배송일 조율 필요"
> 3. 비개발자에게 기술 용어 대신 **일상 언어**로 표현: "Dirty Read 가능성" → "주문 수정 중일 수 있으니 확인해주세요"
>
> **이 라운드는 Tech Lead의 완전 승리다.** 사용자 경험을 개선하는 제안이므로 즉시 반영한다.

### ✅ 결정: **Tech Lead 승리 — 즉시 반영**

- 경고 3단계 분류 체계 도입 (`❌` / `⚠️` / `ℹ️`)
- 각 경고에 **권장 조치(Suggested Action)** 문구 추가
- SKILL.md에 경고 등급별 에이전트 출력 가이드 명시

---

## 🏗️ Round 7: 개인정보 보호 — 연락처·주문자 데이터 처리

### 🔴 Tech Lead 비판

> **[Security / Privacy: HIGH]**
>
> 시트에 `주문자`(이름), `연락처`(전화번호) 컬럼이 있다. 이게 리포트에 그대로 노출된다면?
>
> 1. **개인정보보호법 위반 가능성**: 주문자 이름+연락처는 개인정보다. 리포트를 Google Docs에 공유하거나 카카오톡으로 전송하면 **개인정보의 제3자 제공**에 해당할 수 있다.
> 2. **데이터 최소화 원칙 위반**: 리포트의 목적은 "원두 집계"인데, 개인 연락처가 왜 필요한가? **목적에 필요한 최소한의 데이터만 처리**해야 한다.
> 3. **리포트 보존 기간**: 리포트를 `reports/YYYY-MM/` 폴더에 보관한다면, 개인정보가 포함된 파일이 **무기한 보존**된다. 보관 기간 정책이 없다.
>
> **Tech Debt Score: 7/10** — 법적 리스크.

### 🟢 Product Lead 방어

> **[Ethics & Privacy 원칙]**
>
> 이것도 타당한 지적이다. Product Lead로서 **Privacy by Design**을 지지한다:
>
> 1. **리포트에 개인정보 미포함 원칙**: 주문자·연락처는 원본 Sheets에만 존재하고, 리포트에는 **매장명·매장코드만** 표시한다.
> 2. 단, 긴급 주문이나 특이사항 발생 시 관리자가 원본 Sheets에서 직접 연락처를 확인하는 워크플로우를 유지한다.
> 3. **주문자·연락처 컬럼의 위상 재정의**: "선택 컬럼"으로 유지하되, **에이전트가 읽되 리포트에 출력하지 않음**을 SKILL.md에 명시.
>
> **Ethics 관점에서 Tech Lead에게 양보한다.**

### ✅ 결정: **Tech Lead 승리 — 즉시 반영**

- 리포트에 `주문자`, `연락처` 컬럼 **미출력** 원칙 확정
- SKILL.md에 "개인정보 미포함 원칙" 섹션 추가
- 연락처 확인이 필요한 경우 관리자가 원본 Sheets에서 직접 확인

---

## 🏗️ Round 8: 리포트 템플릿의 경직성 — 커스터마이징 불가

### 🔴 Tech Lead 비판

> **[System Architecture: MODERATE]**
>
> `templates/daily_report.md`가 고정 템플릿이다. 그런데 로스터리마다 필요한 정보가 다르다:
>
> 1. **로스터리 A**: 배송 스케줄이 가장 중요 (직접 배송)
> 2. **로스터리 B**: 원두별 합산만 필요 (택배 일괄 발송)
> 3. **로스터리 C**: 원가 리포트가 핵심 (마진 관리)
>
> 한 가지 템플릿으로 모든 로스터리를 만족시킬 수 있는가? `reports` 설정에 3가지 리포트 종류가 있지만, **섹션 순서 변경, 불필요한 섹션 숨기기, 커스텀 컬럼 추가** 등은 불가능하다.
>
> **Tech Debt Score: 4/10** — 현재는 중요하지 않지만 다중 고객 서비스 시 병목.

### 🟢 Product Lead 방어

> **[10x Differentiation / Growth Loop]**
>
> 유효한 지적이지만, **시기의 문제**다:
>
> 1. **v1은 단일 로스터리**: 현재 "블랙업" 한 곳을 위한 시스템이다. 다중 고객은 아직 고려 대상이 아니다.
> 2. **settings.yaml의 `reports` 리스트가 이미 토글**: `daily_summary`, `bean_totals`, `delivery_schedule` 중 필요한 것만 활성화할 수 있다. 이 수준이면 v1에 충분하다.
> 3. 그러나 **v1.5에서 리포트 섹션 on/off 세분화**는 합리적이다.
>
> **부분 양보**: settings.yaml에 리포트 섹션별 활성화 옵션을 v1.5에 추가 검토.

### ✅ 결정: **부분 수용 (v1.5)**

- v1은 현행 유지 (3종 리포트 토글)
- v1.5에 **리포트 섹션별 on/off** 옵션 추가 검토:
  ```yaml
  report_sections:
    cost_summary: false      # 원가 요약
    store_detail: true       # 매장별 상세
    delivery_by_zone: true   # 구역별 배송
  ```

---

## 🏗️ Round 9: 멀티테넌시 — 다른 로스터리가 쓰고 싶다면?

### 🔴 Tech Lead 비판

> **[System Architecture: STRATEGIC]**
>
> 만약 이 시스템이 잘 작동해서 **다른 로스터리도 쓰고 싶다고 한다면?** 현재 아키텍처로는 불가능하다:
>
> 1. **settings.yaml이 하드코딩**: 매장 목록, 원두 목록이 특정 로스터리에 종속. 다른 로스터리는 **별도 프로젝트를 복제**해야 한다.
> 2. **SKILL.md도 단일 테넌트**: "강남점, 홍대점, 성수점"이 가이드에 예시로 박혀있다.
> 3. **인증 격리 불가**: 브라우저 기반이므로, 로스터리 A의 Sheets와 B의 Sheets를 **동일 브라우저 세션**에서 접근할 수 없다 (구글 계정이 다르면).
>
> **Tech Debt Score: 3/10** — 현재는 문제 아님. 그러나 사업 확장 시 **아키텍처 전면 재작성**이 필요한 "숨은 폭탄"이다.

### 🟢 Product Lead 방어

> **[Growth & Retention Loop]**
>
> 이것은 "좋은 문제(Good Problem)"다. **사용자가 있어야 확장을 걱정한다.**
>
> 1. **먼저 1명의 열렬한 사용자를 만들자**: 10개 로스터리를 위한 플랫폼을 만들다가 1명의 사용자도 못 만드는 게 스타트업 실패의 전형이다.
> 2. **확장 전략은 "복제"**: 현재 구조에서 다른 로스터리가 쓰려면 디렉토리를 복제하고 settings.yaml만 수정하면 된다. 이것이 **가장 빠른 멀티테넌시**다. 기술적으로 우아하지 않지만, 5명의 고객까지는 이 방식으로 충분하다.
> 3. **멀티테넌시 리팩토링 트리거**: 고객 5개 이상에서 관리 비용이 복제 비용을 초과하면, 그때 템플릿화/멀티테넌시 아키텍처를 설계한다.
>
> **판단**: 현 단계에선 과잉 우려. 단, **settings.yaml에서 로스터리 이름 등을 변수화**하는 정도는 반영 가치가 있다.

### ✅ 결정: **수용 (최소 변수화)**

- settings.yaml에 `roastery` 최상위 섹션 추가:
  ```yaml
  roastery:
    name: "블랙업 커피 로스터스"
    code: "BLACKUP"
  ```
- SKILL.md와 리포트 템플릿에서 로스터리명을 하드코딩 대신 **settings 참조**
- 멀티테넌시 아키텍처는 v2+ 로드맵

---

## 🏗️ Round 10: 운영 의존성 — "매일 실행해야 한다"의 함정

### 🔴 Tech Lead 비판

> **[SRE / Operational Resilience: WARNING]**
>
> 이 시스템은 **관리자가 매일 수동으로 "오늘 주문 정리해줘"라고 말해야** 동작한다:
>
> 1. **관리자 부재 시 중단**: 관리자가 아프거나, 출장 가거나, 잊어버리면? 그날의 주문 정리는 **0%**다. 시스템이 사람에게 의존하면 사람이 Single Point of Failure가 된다.
> 2. **주말/공휴일 처리 미정의**: 금요일 주문과 월요일 주문 사이에 토/일 주문이 있으면? 월요일에 "지난 3일치 정리해줘"가 가능한지 불명확하다.
> 3. **스케줄 자동화 없음**: cron이나 Cloud Scheduler 같은 자동 트리거가 없다. "알림을 보내서 관리자에게 실행을 상기시키는" 것조차 없다.
>
> **Tech Debt Score: 6/10** — 자동화 시스템인데 트리거가 수동이라는 모순.

### 🟢 Product Lead 방어

> **[Core UX / Desirability]**
>
> "자동 실행"의 매력에 빠지기 쉬우나, **지금은 수동이 더 낫다:**
>
> 1. **관리자의 통제감**: 자동 실행은 "내가 모르는 사이에 뭔가 돌아갔다"는 불안감을 준다. 로스터리 사장님은 **직접 명령하고, 결과를 확인하는** 워크플로우를 선호한다. 이것이 "Desirability"다.
> 2. **유연한 실행 시점**: 매일 17시가 아니라, 때에 따라 점심에 한 번+저녁에 한 번 돌릴 수도 있다. 자동 스케줄은 이 유연성을 제한한다.
> 3. **주말/공휴일**: SKILL.md에 가이드 추가 — "주말 미실행 시, 월요일에 '2/13~2/15 주문 정리해줘'로 기간 지정 가능"
>
> **단, 합리적 우려이므로** SKILL.md에 "주말/공휴일 미실행 시 복수일 처리 가이드"를 추가한다.

### ✅ 결정: **부분 수용**

- v1: 수동 트리거 유지 (관리자 통제 우선)
- SKILL.md에 **복수일 일괄 처리 가이드** 추가:
  - "2/13~2/15 주문 정리해줘" 같은 기간 지정 형식 안내
  - 복수일 처리 시 일자별 분리 출력 vs 합산 출력 옵션
- v2 로드맵: 정기 자동 실행(opt-in) + 미실행 시 리마인더 알림

---

## 🏗️ Round 11: 비용 효율성 — 에이전트 실행 비용 vs 수작업 인건비

### 🔴 Tech Lead 비판

> **[Carbon Footprint / Cost Efficiency: WARNING]**
>
> Antigravity 에이전트 실행에는 **비용이 든다.** 매일 실행하면:
>
> 1. **LLM API 호출 비용**: 에이전트가 SKILL.md를 읽고, 여러 Sheets를 순회하고, 리포트를 생성한다. 한 번 실행에 **수천~수만 토큰**을 소모한다. 월 30회 × 토큰 비용 = ?
> 2. **비용 투명성 부재**: 기획서 어디에도 "월 예상 운영 비용"이 없다. 관리자가 3개월 쓰고 "이거 왜 이렇게 비싸?" 할 수 있다.
> 3. **Green Computing**: 브라우저 렌더링으로 Sheets 접근 = CPU/메모리 불필요 소모. API라면 HTTP 요청 하나로 끝날 것을 풀 브라우저 세션으로 처리한다. **탄소 발자국 관점에서 비효율적**이다.
>
> **Tech Debt Score: 5/10** — 비용이 가치를 초과하면 시스템의 존재 이유가 사라진다.

### 🟢 Product Lead 방어

> **[Success Metrics / ROI 분석]**
>
> 비용 분석을 해보자:
>
> 1. **As-Is 인건비**: 관리자 시급 2만원 × 일 1시간 × 월 25일 = **50만원/월**
> 2. **에이전트 비용**: Antigravity 구독 비용을 고려해도, 하루 1회 실행의 토큰 비용은 **월 5만원 이하**로 추정. ROI는 **10:1** 이상이다.
> 3. **Carbon Footprint**: 유효한 우려지만, 수량적으로 하루 1회 브라우저 세션의 탄소 배출량은 **관리자가 엑셀을 1시간 켜놓는 것과 비교해** 유의미한 차이가 없다.
>
> **단, 투명성은 추가하겠다:** 리포트 메타데이터에 "에이전트 실행 토큰 사용량(추정)" 표시를 v1.5에서 검토한다.

### ✅ 결정: **부분 수용**

- SKILL.md에 **예상 운영 비용 가이드** 섹션 추가 (월 비용 추정치 안내)
- 리포트 메타데이터에 **실행 소요 시간** 표시 (v1)
- 토큰 사용량/비용 추정 표시는 v1.5 검토

---

## 🏗️ Round 12: 엣지 케이스 — 빈 시트, 0건 주문, 초대량 주문

### 🔴 Tech Lead 비판

> **[Failure Mode Analysis: MODERATE]**
>
> 정상 시나리오만 설계되어 있다. 비정상 시나리오를 본다:
>
> 1. **빈 시트**: 매장이 오늘 주문을 안 넣었다. 시트가 비어있다. 에이전트는 어떻게 하는가? 에러인가? "0건"으로 처리하나?
> 2. **0kg 주문**: 수량에 0을 입력했다. 의미 있는 데이터인가? 실수인가?
> 3. **초대량 주문**: 평소 5kg 주문하던 매장이 갑자기 500kg을 주문했다. 오타일 가능성이 높은데, **이상치(Outlier) 감지**가 없다.
> 4. **시트 접근 불가**: Sheets 공유 설정이 변경되어 에이전트가 접근 불가 시, 해당 매장만 스킵하는지 전체가 실패하는지?
>
> **Tech Debt Score: 6/10** — 엣지 케이스 미처리는 "조용한 실패"의 원인.

### 🟢 Product Lead 방어

> **[Service Logic Flow]**
>
> 전부 유효한 케이스다. 하나씩 정리하겠다:
>
> 1. **빈 시트**: "해당 매장 주문 0건" 으로 정상 처리. 리포트에 "강남점: 주문 없음" 표시.
> 2. **0kg 주문**: 교차검증의 "수량 숫자 검증"에서 `⚠️ 수량 0 — 의도된 주문인지 확인` 경고.
> 3. **이상치 감지**: 좋은 제안이다. settings.yaml에 `max_order_kg: 50` 같은 임계값을 넣고, 초과 시 `⚠️ 이상 수량` 경고.
> 4. **접근 불가**: 해당 매장만 스킵하고, 나머지 매장은 정상 처리. 리포트에 "❌ 강남점: 시트 접근 불가 — 공유 설정 확인 필요" 표시.
>
> **이 라운드도 Tech Lead 승리.** 엣지 케이스 처리 가이드를 SKILL.md에 추가한다.

### ✅ 결정: **Tech Lead 승리 — 즉시 반영**

- SKILL.md에 **엣지 케이스 처리 가이드** 추가:
  - 빈 시트 → "주문 0건" 정상 처리
  - 0kg 주문 → `⚠️ 수량 0` 경고
  - 시트 접근 불가 → 해당 매장 스킵 + `❌` 경고
- settings.yaml에 **이상치 임계값** 추가:
  ```yaml
  max_order_kg: 50    # 단일 주문 최대치 (초과 시 경고)
  ```
- 교차검증 항목에 **이상 수량 감지** 추가

---

## 🏗️ Round 13: 리포트 버전 관리 — "어제 리포트와 다른데?"

### 🔴 Tech Lead 비판

> **[Tech Debt Control: MODERATE]**
>
> 같은 날짜에 에이전트를 2번 실행하면 리포트가 **덮어써진다:**
>
> 1. **덮어쓰기 위험**: 오전에 리포트 생성 → 오후에 주문 추가 → 재실행하면 이전 리포트는 사라진다. "오전 버전에 뭐가 있었지?" 추적 불가.
> 2. **리포트 diff 불가**: 어제와 오늘의 리포트를 비교해서 "뭐가 달라졌지?"를 확인할 방법이 없다.
> 3. **감사 추적(Audit Trail)**: 규모가 커지면 세무/회계 감사에서 "이 날 실제 주문이 뭐였는지" 증빙이 필요할 수 있다. 단일 파일 덮어쓰기는 증빙 불가.
>
> **Tech Debt Score: 5/10** — 현재는 낮은 리스크, 장기적으로 문제.

### 🟢 Product Lead 방어

> **[Service Logic Flow]**
>
> 간단한 해결책이 있다:
>
> 1. **리포트 파일명에 실행 시각 포함**: `daily_report_2026-02-15_1730.md` 형식으로, 같은 날 여러 번 실행해도 모든 버전이 보존된다.
> 2. 최신 리포트를 `daily_report_2026-02-15_latest.md`로 심볼릭 링크/복사하여 편의 제공.
> 3. **감사 추적은 v2 scope**: 현재 3개 매장 규모에서 세무 감사 대비는 과잉. 단, 리포트 파일 보존이면 최소한의 증빙은 된다.
>
> **양보 포인트**: 파일명 형식을 개선하는 것은 비용이 거의 0이므로 즉시 반영한다.

### ✅ 결정: **수용 — 즉시 반영**

- 리포트 파일명 규칙 변경:
  ```
  daily_report_YYYY-MM-DD_HHMM.md  (예: daily_report_2026-02-15_1730.md)
  ```
- 동일 날짜 재실행 시 이전 리포트 **보존** (덮어쓰지 않음)
- SKILL.md에 네이밍 규칙 업데이트

---

## 🏗️ Round 14: 경쟁 해자 — 왜 이걸 써야 하는가?

### 🔴 Tech Lead 비판

> **[System Architecture: STRATEGIC]**
>
> 기술적 해자(Technical Moat)가 없다:
>
> 1. **복제 용이성**: SKILL.md + settings.yaml + 템플릿 = 누구나 2시간이면 똑같은 걸 만들 수 있다. **지적 재산이 없다.**
> 2. **범용 도구 대체 가능**: ChatGPT에게 "Google Sheets에서 주문 데이터 읽어서 정리해줘"라고 해도 비슷한 결과가 나올 수 있다. **에이전트 종속성만 있고 고유 가치가 없다.**
> 3. **전환 비용(Switching Cost) 제로**: 다른 도구로 옮기는 데 장벽이 없다. 데이터는 Google Sheets에, 리포트는 Markdown. **Lock-in이 없다는 것은 곧 Retention도 없다는 뜻이다.**
>
> **Tech Debt Score: 2/10** — 기술 부채가 아니라 사업 리스크.

### 🟢 Product Lead 방어

> **[Growth & Retention Loop / 10x Differentiation]**
>
> Tech Lead가 사업 영역에 들어왔으니, 본 게임(Home Turf)에서 답하겠다:
>
> 1. **해자는 "시스템"이 아니라 "지식"이다**: SKILL.md에 축적된 **도메인 지식** — 로스팅 리드타임, 배송 구역화, 중복 주문 패턴, 원두 코드 체계 — 이것이 우리의 해자다. 다른 사람이 2시간 만에 만들 수 있으나, 이 수준의 도메인 최적화는 **10라운드의 현장 피드백** 없으면 불가능하다.
> 2. **Lock-in 제로가 오히려 Trust**: 사용자가 "언제든 떠날 수 있다"고 느끼면, 역설적으로 **신뢰가 높아져서 더 오래 쓴다.** 이것이 Google Docs, Notion 등 성공 서비스의 전략이다.
> 3. **Retention은 설정에 축적된 커스터마이징**: settings.yaml에 쌓인 매장 목록, 원두 프로파일, 구역 설정 등이 **전환 비용**이다. "새 도구에서 이걸 다시 세팅해야 해?"가 Retention의 핵심.
> 4. **진짜 해자 = 운영 습관**: 관리자가 매일 "오늘 주문 정리해줘"를 **습관으로 형성**하면, 다른 도구로 전환하는 것은 습관을 바꾸는 것이다. 가장 강력한 Lock-in은 습관이다.
>
> **이 라운드는 사업 영역이므로 Product Lead가 방어한다.** 단, settings.yaml의 커스터마이징 수준을 높여 전환 비용을 자연스럽게 형성하겠다.

### ✅ 결정: **Product Lead 우세**

- settings.yaml의 커스터마이징 옵션을 풍부하게 유지 (전환 비용 형성)
- SKILL.md에 축적되는 **도메인 지식을 체계적으로 문서화** (운영 노하우를 명시적 자산으로)
- v2에서 "운영 히스토리 대시보드" 검토 (얼마나 정리했는지, 어떤 패턴이 있는지)

---

## 🏗️ Round 15: 테스트 전략의 부재 — 어떻게 "잘 되는지" 확인할 것인가?

### 🔴 Tech Lead 비판

> **[SRE / Quality Assurance: CRITICAL]**
>
> Verification Plan에 2가지만 있다: "브라우저 접근 테스트" + "집계 정확성". 이건 **테스트 전략이 아니라 희망 사항**이다:
>
> 1. **테스트 데이터 부재**: `examples/sample_sheet_data.md`에 "샘플"이 있다지만, 실제 Google Sheets에 로드할 수 있는 **테스트 데이터 셋**이 없다. 경고 조건, 엣지 케이스를 모두 커버하는 데이터가 필요하다.
> 2. **기대 출력(Expected Output) 없음**: "집계 정확성"을 어떻게 검증하나? 입력 데이터에 대한 **정답 리포트**가 정의되어 있지 않다. "에이전트가 만든 결과를 눈으로 확인"은 테스트가 아니다.
> 3. **회귀 테스트 불가**: SKILL.md를 수정할 때마다 이전 버전과 같은 결과가 나오는지 확인할 방법이 없다. **비결정적 시스템의 회귀 테스트**는 더 어렵고 더 중요하다.
> 4. **부하 테스트 없음**: 현재 3개 매장인데, 8개로 늘면 에이전트 실행 시간은? 타임아웃은? 기준조차 없다.
>
> **Tech Debt Score: 8/10** — 테스트 없는 시스템은 자신감 없이 운영하는 시스템이다.

### 🟢 Product Lead 방어

> **[Success Metrics / 품질 기준]**
>
> 공식 테스트 전략의 부재는 인정한다. 그러나 **에이전트 기반 시스템의 테스트는 기존과 다르다:**
>
> 1. **골든 테스트 셋 제안 수용**: `examples/` 폴더에 **테스트 시나리오별 입력 데이터 + 기대 출력**을 정의한다:
>    - 정상 시나리오 (3개 매장, 5건 주문)
>    - 경고 시나리오 (재고 부족 + 납기 촉박 + 미등록 원두)
>    - 엣지 시나리오 (빈 시트 + 0kg + 이상 수량)
> 2. **수동 검증 프로토콜**: 비개발자(실제 매장 직원)가 테스트 데이터를 입력하고 리포트를 확인하는 UAT(User Acceptance Test)를 v1 출시 전 1회 수행.
> 3. **회귀 테스트**: 골든 테스트 셋의 입력으로 리포트를 생성하고, 기대 출력과 **핵심 수치(총 건수, 총 수량, 경고 건수)만 비교**한다. 전체 텍스트 일치는 비결정적 시스템에서 불가능하므로.
>
> **이 라운드는 Tech Lead 승리.** 테스트 전략 강화는 비즈니스 관점에서도 "리포트 신뢰성 = 사용자 신뢰"이므로 즉시 반영한다.

### ✅ 결정: **Tech Lead 승리 — 즉시 반영**

- `examples/` 폴더에 **3가지 테스트 시나리오** 정의:
  - `test_normal.md` — 정상 데이터 + 기대 출력
  - `test_warnings.md` — 경고 조건 포함 + 기대 경고 목록
  - `test_edge_cases.md` — 빈 시트, 0kg, 이상 수량 + 기대 처리 결과
- SKILL.md에 **"검증 실행 가이드"** 추가:
  - "테스트 데이터로 검증하기" 섹션
  - 핵심 수치 비교 기준 명시
- v1 출시 전 **UAT 1회** 필수 수행

---

## 📊 전체 판정 요약 (15 Rounds)

| # | 쟁점 | Tech Lead 핵심 지적 | Product Lead 핵심 방어 | 판정 |
|---|------|---------------------|----------------------|------|
| 1 | 단일 실패점 / SLO 부재 | 브라우저 세션 불안정, 재시도 전략 없음 | As-Is 대비 10x 개선, MVP에 SLA는 과잉 | 🟡 **PL 우세** |
| 2 | Google Sheets 확장성 한계 | Dirty Read, O(n) 스케일 | 비개발자 대상, 실존 규모에서 과잉 | 🟡 **PL 우세** |
| 3 | Self-Validation 패러독스 | 자기 검증의 한계 | 검증 0%→80% 향상 | ⚖️ **무승부** |
| 4 | settings.yaml 비대화 | SRP 위반, 수동 재고 관리 | 파일 1개 = 인지 부하 최소 | 🟡 **PL 우세** |
| 5 | 스크립트 0개 리스크 | 비결정적, Vendor Lock-in | 비개발자 온보딩 장벽 제거 | 🔴 **양보 필요** |
| 6 | 에러 메시지 UX | 경고 후 조치 안내 부재 | 전적 동의, 즉시 반영 | 🔵 **TL 승리** |
| 7 | 개인정보 보호 | 리포트에 연락처 노출 위험 | Privacy by Design 수용 | 🔵 **TL 승리** |
| 8 | 리포트 템플릿 경직성 | 커스터마이징 불가 | v1은 단일 고객, v1.5에서 개선 | 🟡 **PL 우세** |
| 9 | 멀티테넌시 부재 | 다른 로스터리 사용 불가 | 먼저 1명의 열렬한 사용자 확보 | ⚖️ **무승부** |
| 10 | 운영 의존성 (수동 트리거) | 관리자 부재 시 중단 | 수동 = 통제감, 복수일 처리 가이드 추가 | 🟡 **PL 우세** |
| 11 | 비용 효율성 | 에이전트 실행 비용 불투명 | ROI 10:1, 비용 투명성 추가 | 🟡 **PL 우세** |
| 12 | 엣지 케이스 미처리 | 빈 시트, 0kg, 이상 수량 | 전적 동의, 즉시 반영 | 🔵 **TL 승리** |
| 13 | 리포트 버전 관리 | 덮어쓰기 위험 | 파일명에 시각 포함으로 해결 | 🔵 **TL 승리** |
| 14 | 경쟁 해자 부재 | 복제 용이, 전환 비용 제로 | 해자는 도메인 지식 + 운영 습관 | 🟡 **PL 우세** |
| 15 | 테스트 전략 부재 | 테스트 데이터·기대 출력 없음 | 골든 테스트셋 + UAT 수용 | 🔵 **TL 승리** |

### 승패 집계

| | 승리 | 우세 | 무승부 | 양보 필요 |
|---|------|------|--------|----------|
| **Tech Lead** | 🔵 5회 (R6, R7, R12, R13, R15) | — | 2회 | — |
| **Product Lead** | — | 🟡 6회 (R1, R2, R4, R8, R10, R11, R14) | 2회 | 🔴 1회 (R5) |

---

## 🎯 서비스 스펙 반영 사항 (최종 정리)

15라운드 논쟁 결과, **즉시 서비스 스펙에 반영해야 할 항목**을 정리한다.

### 1️⃣ SKILL.md 추가/변경 사항

| # | 항목 | 출처 | 내용 |
|---|------|------|------|
| S1 | 실패 시 대응 가이드 | R1 합의 | 어디까지 처리했는지 확인 → 해당 매장부터 재시도 방법 안내 |
| S2 | settings.yaml 구문 검증 | R4 합의 | YAML 로드 시 기본 구문 검증 수행, 에러 시 사용자 친화적 메시지 |
| S3 | 경고 등급 가이드 | R6 결정 | 3단계(`❌`/`⚠️`/`ℹ️`) 분류 기준 + 에이전트 출력 형식 |
| S4 | 개인정보 미포함 원칙 | R7 결정 | 리포트에 주문자·연락처 컬럼 미출력, 원본에서만 확인 |
| S5 | 엣지 케이스 처리 | R12 결정 | 빈 시트(0건 처리), 0kg(경고), 시트 접근 불가(스킵+경고) |
| S6 | 복수일 일괄 처리 | R10 합의 | "2/13~2/15 주문 정리" 기간 지정 형식 + 일자별/합산 출력 옵션 |
| S7 | 예상 운영 비용 안내 | R11 합의 | 월 예상 비용 추정치 (에이전트 실행 기준) |
| S8 | 검증 실행 가이드 | R15 결정 | 테스트 데이터로 검증하는 방법, 핵심 수치 비교 기준 |

### 2️⃣ settings.yaml 추가/변경 사항

| # | 항목 | 출처 | 변경 내용 |
|---|------|------|----------|
| Y1 | `roastery` 섹션 신설 | R9 결정 | `name`, `code` 필드 (멀티테넌시 변수화 기반) |
| Y2 | `max_order_kg` 추가 | R12 결정 | 단일 주문 최대치 임계값 (기본값 `50`) |

```yaml
# === 신규 추가 ===
roastery:                    # Round 9
  name: "블랙업 커피 로스터스"
  code: "BLACKUP"

max_order_kg: 50             # Round 12 — 이상 수량 경고 임계값
```

### 3️⃣ 교차검증 항목 추가

| # | 검증 항목 | 출처 | 유형 | 설명 |
|---|-----------|------|------|------|
| V1 | 이상 수량 감지 | R12 | `⚠️` WARNING | `수량 > max_order_kg` 시 경고 |
| V2 | 수량 0 감지 | R12 | `⚠️` WARNING | 수량 = 0인 주문 경고 |
| V3 | 시트 접근 불가 | R12 | `❌` CRITICAL | 접근 불가 매장 스킵 + 경고 |

### 4️⃣ 리포트 형식 변경

| # | 항목 | 출처 | 변경 내용 |
|---|------|------|----------|
| R1 | 경고 3단계 분류 | R6 | `❌ CRITICAL` / `⚠️ WARNING` / `ℹ️ INFO` + 각 경고에 권장 조치 |
| R2 | 개인정보 제외 | R7 | 주문자·연락처 컬럼 리포트 미포함 |
| R3 | 파일명 규칙 변경 | R13 | `daily_report_YYYY-MM-DD_HHMM.md` (시각 포함, 덮어쓰기 방지) |
| R4 | 실행 메타데이터 | R1·R11 합의 | 리포트 하단에 실행 시각·처리 매장 목록·소요 시간 표시 |

### 5️⃣ 테스트 자산 추가

| # | 파일 | 출처 | 내용 |
|---|------|------|------|
| T1 | `examples/test_normal.md` | R15 | 정상 데이터 3매장 5건 + 기대 출력 |
| T2 | `examples/test_warnings.md` | R15 | 재고 부족·납기 촉박·미등록 원두 + 기대 경고 |
| T3 | `examples/test_edge_cases.md` | R15 | 빈 시트·0kg·이상 수량·접근 불가 + 기대 처리 결과 |

### 6️⃣ v1.5 / v2 로드맵 추가 항목

| 시점 | 항목 | 출처 |
|------|------|------|
| v1.5 | 비상용 간이 집계 스크립트 (CSV → 합산) | R5 |
| v1.5 | settings.yaml 구문 검증 도구 | R4 |
| v1.5 | 리포트 섹션별 on/off 옵션 | R8 |
| v1.5 | 에이전트 실행 비용 투명성 (토큰 추정) | R11 |
| v2 | Google Sheets API 전환 검토 | R2 |
| v2 | 독립 교차검증 모듈 | R3 |
| v2 | 실행 이력 로그 자동 생성 | R3 |
| v2 | 정기 자동 실행(opt-in) + 리마인더 | R10 |
| v2 | 운영 히스토리 대시보드 | R14 |
| v2+ | 멀티테넌시 아키텍처 | R9 |
