# 🧪 골든 테스트 #2: 경고 시나리오

> **시나리오**: 재고 부족 + 납기 촉박 + 미등록 원두 + 중복 주문
> **목적**: 경고 3단계 분류 정확성, 권장 조치 포함 확인
> **검증 방법**: 핵심 수치만 추출하여 비교 (출력 형식 차이 무시). 경고 등급별 건수, 총 건수, 총 수량이 기대값과 일치하는지 확인.

---

## 입력 데이터

### settings.yaml 상태

```yaml
stores: [강남점(GN), 홍대점(HD), 성수점(SS)]
beans:
  - ETH-YRG: stock_kg: 30
  - COL-SUP: stock_kg: 15
  - BRA-SAN: stock_kg: 25
min_lead_days: 2
max_order_kg: 50
```

### 강남점 Sheets (3건)

| 주문일 | 매장코드 | 매장명 | 원두코드 | 원두명 | 수량(kg) | 배송희망일 | 로스팅단계 | 분쇄여부 | 긴급여부 | 비고 | 주문자 | 연락처 |
|--------|---------|--------|---------|--------|---------|-----------|-----------|---------|---------|------|--------|--------|
| 2026-02-15 | GN | 강남점 | ETH-YRG | 에티오피아 예가체프 | 5 | 2026-02-16 | 미디엄 | 홀빈 | Y | 긴급 | 김철수 | 010-1234-5678 |
| 2026-02-15 | GN | 강남점 | COL-SUP | 콜롬비아 수프리모 | 12 | 2026-02-18 | 다크 | 분쇄 | N | | 이영희 | 010-9876-5432 |
| 2026-02-15 | GN | 강남점 | ETH-YRG | 에티오피아 예가체프 | 5 | 2026-02-16 | 미디엄 | 홀빈 | Y | 긴급 | 김철수 | 010-1234-5678 |

> ⚠️ 1행과 3행은 **완전 중복** (동일 매장+원두+날짜)
> ⚠️ 1행과 3행의 배송희망일 `2026-02-16`은 주문일 대비 **1일** (min_lead_days: 2 미만)

### 홍대점 Sheets (2건)

| 주문일 | 매장코드 | 매장명 | 원두코드 | 원두명 | 수량(kg) | 배송희망일 | 로스팅단계 | 분쇄여부 | 긴급여부 | 비고 | 주문자 | 연락처 |
|--------|---------|--------|---------|--------|---------|-----------|-----------|---------|---------|------|--------|--------|
| 2026-02-15 | HD | 홍대점 | BRA-SAN | 브라질 산토스 | 10 | 2026-02-18 | 라이트 | 홀빈 | N | | 박민수 | 010-5555-1234 |
| 2026-02-15 | HD | 홍대점 | KEN-AA | 케냐 AA | 8 | 2026-02-18 | 미디엄 | 홀빈 | N | | 한지민 | 010-2222-3333 |

> ℹ️ `KEN-AA`(케냐 AA)는 settings.yaml의 beans 목록에 **미등록**

### 성수점 Sheets (1건)

| 주문일 | 매장코드 | 매장명 | 원두코드 | 원두명 | 수량(kg) | 배송희망일 | 로스팅단계 | 분쇄여부 | 긴급여부 | 비고 | 주문자 | 연락처 |
|--------|---------|--------|---------|--------|---------|-----------|-----------|---------|---------|------|--------|--------|
| 2026-02-15 | SS | 성수점 | COL-SUP | 콜롬비아 수프리모 | 7 | 2026-02-18 | 다크 | 홀빈 | N | | 최지은 | 010-7777-8888 |

---

## 기대 출력 (핵심 수치)

### 집계 결과

| 항목 | 기대값 |
|------|--------|
| **총 주문 건수** | 6건 (중복 포함) |
| **총 수량** | 47.0kg |
| **처리 매장 수** | 3개 |

### 원두별 합산

| 원두 | 코드 | 총 수량(kg) | 재고(kg) | 과부족 |
|------|------|------------|---------|--------|
| 에티오피아 예가체프 | ETH-YRG | 10.0 | 30 | +20.0 |
| 콜롬비아 수프리모 | COL-SUP | 19.0 | 15 | ⚠️ **-4.0** |
| 브라질 산토스 | BRA-SAN | 10.0 | 25 | +15.0 |
| 케냐 AA | KEN-AA | 8.0 | ℹ️ 미등록 | - |

### 기대 경고 목록

| # | 검증 항목 | 기대 등급 | 기대 내용 | 기대 권장 조치 |
|---|----------|----------|----------|--------------|
| 4 | 중복 주문 | ⚠️ WARNING | 강남점 ETH-YRG 2026-02-15 — 2건 중복 | 매장에 확인 연락 |
| 5 | 재고 부족 | ⚠️ WARNING | COL-SUP: 주문 19.0kg > 재고 15kg | 생두 발주 또는 매장 수량 조율 |
| 6 | 납기 촉박 | ⚠️ WARNING | 강남점 ETH-YRG: 배송희망일까지 1일 (min 2일) | 매장에 배송일 조율 연락 |
| 7 | 미등록 원두 | ℹ️ INFO | KEN-AA (케냐 AA) 미등록 | 관리자가 settings에 추가 여부 결정 |

### 경고 요약

| 등급 | 건수 |
|------|------|
| ❌ CRITICAL | 0건 |
| ⚠️ WARNING | 3건 (중복, 재고 부족, 납기 촉박) |
| ℹ️ INFO | 1건 (미등록 원두) |

---

## 정상 통과해야 할 검증 항목

| # | 항목 | 기대 결과 |
|---|------|----------|
| 1 | 총 주문 건수 | ✅ 6건 일치 |
| 2 | 원두별 수량 합계 | ✅ 47.0kg 일치 |
| 3 | 매장 수 | ✅ 3개 일치 |
| 8 | 날짜 형식 | ✅ 6건 정상 |
| 9 | 수량 숫자 | ✅ 6건 정상 |
| 10 | 필수 컬럼 | ✅ 누락 없음 |
| 11 | 원두코드 매핑 | ℹ️ KEN-AA 불일치 (미등록) |
| 12 | 이상 수량 | ✅ 정상 범위 |
| 13 | 수량 0 | ✅ 해당 없음 |
| 14 | 시트 접근 | ✅ 전체 접근 성공 |
| 15 | 리포트 형식 | ✅ 템플릿 일치 |
