# 📊 Google Sheets 템플릿 셋업 가이드

> **Version 1.0** | 2026-02-16 | 대상: 로스터(관리자) 또는 IT 서포트 담당자
>
> 이 문서는 10개 매장 주문 시트와 마스터 코드표 시트를 만드는 **완전한 가이드**입니다.

---

## 📋 목차

1. [전체 구조](#1-전체-구조)
2. [마스터 코드표 시트 만들기](#2-마스터-코드표-시트-만들기)
3. [매장 주문 시트 만들기](#3-매장-주문-시트-만들기)
4. [데이터 유효성 검사 설정](#4-데이터-유효성-검사-설정)
5. [헤더 보호 설정](#5-헤더-보호-설정)
6. [매장에 복제 및 배포](#6-매장에-복제-및-배포)
7. [IMPORTRANGE 연동](#7-importrange-연동)
8. [검증 체크리스트](#8-검증-체크리스트)

---

## 1. 전체 구조

```
📗 [마스터] 블랙업 코드표 (1개)
 ├── 탭: 매장코드
 ├── 탭: 원두코드
 └── 탭: 로스팅/분쇄 옵션

📘 [매장별] 블랙업_주문_서면본점 (10개)
 ├── 탭: 주문 ← 에이전트가 읽는 탭 (첫 번째 탭이어야 함)
 ├── 탭: 코드표 ← 마스터에서 IMPORTRANGE로 연동
 └── 탭: 🔖 입력 가이드
```

**핵심 원칙**: 코드표는 마스터 1곳에서만 관리 → 원두 추가/변경 시 마스터만 수정하면 10개 시트에 자동 반영

### ⏱️ 예상 소요 시간

| 작업 | 소요 시간 |
|------|--------|
| 마스터 코드표 시트 생성 | 10분 |
| 매장 시트 1개 생성 (템플릿) | 15분 |
| 나머지 9개 복제 + 권한 설정 | 20분 |
| IMPORTRANGE 연결 (10개) | 15분 |
| Antigravity에 URL 등록 | 10분 |
| **총합** | **약 70분** |

> IT 서포트가 함께 하면 **45분 내 완료** 가능합니다.

---

## 2. 마스터 코드표 시트 만들기

### 2.1 새 Google Sheets 생성

- 이름: `블랙업_코드표_마스터`
- 이 시트는 **로스터만 편집** 가능하게 설정

### 2.2 탭 1: 매장코드

| A (코드) | B (매장명) | C (zone) | D (주소) |
|---------|----------|---------|--------|
| RST | 로스터리 | 부산진구 | 부산진구 신천대로 108 |
| SM | 서면 본점 | 부산진구 | 부산진구 서전로10번길 41 |
| HD | 해운대 | 해운대구 | 해운대구 중동2로 16 1층 |
| ESD | 을숙도 | 사하구 | 사하구 낙동남로 1233번길 30 |
| LGR | 롯데 광복 | 중구 | 중구 중앙대로 2 아쿠아몰 B1 |
| YS | 양산 | 양산시 | 양산시 물금읍 물금리 376-12 |
| GSW | 거제 수월 | 거제시 | 거제시 제산안길 18 |
| GH | 고현 | 거제시 | 거제시 서문로5길 6 1층 |
| UOD | 울산 옥동 | 울산남구 | 남구 법대로14번길 21 |
| UHD | 울산 현대백화점 | 울산남구 | 남구 삼산로 261 별관 3층 |

### 2.3 탭 2: 원두코드

| A (코드) | B (원두명) | C (영문명) |
|---------|----------|----------|
| ETH-YRG | 에티오피아 예가체프 | Ethiopia Yirgacheffe |
| COL-SUP | 콜롬비아 수프리모 | Colombia Supremo |
| BRA-SAN | 브라질 산토스 | Brazil Santos |

> 📌 **새 원두 추가 시**: 이 탭에 행 추가 → 10개 매장 시트 드롭다운에 자동 반영

### 2.4 탭 3: 옵션

| A (로스팅단계) | B (분쇄여부) | C (긴급여부) |
|-------------|-----------|-----------|
| 라이트 | 홀빈 | Y |
| 미디엄 | 분쇄 | N |
| 다크 | | |

---

## 3. 매장 주문 시트 만들기

### 3.1 새 Google Sheets 생성

- 이름: `블랙업_주문_서면본점` (매장별로 변경)
- 이 시트가 **마스터 템플릿**이 됩니다

### 3.2 탭 1: 주문 (반드시 첫 번째 탭)

**⚠️ 에이전트는 첫 번째 탭만 읽습니다. '주문' 탭이 반드시 첫 번째여야 합니다.**

1행 (헤더 — 보호 대상):

| A | B | C | D | E | F | G | H | I | J | K | L | M |
|---|---|---|---|---|---|---|---|---|---|---|---|---|
| 주문일 | 매장코드 | 매장명 | 원두코드 | 원두명 | 수량(kg) | 배송희망일 | 로스팅단계 | 분쇄여부 | 긴급여부 | 비고 | 주문자 | 연락처 |

2행부터 데이터 입력 시작.

> **💡 매장코드·매장명 고정값 설정 (권장)**
>
> 각 매장 시트에서 B열과 C열에 해당 매장의 코드와 이름을 미리 입력해두면
> 바리스타가 매번 선택하지 않아도 됩니다:
> - 서면본점 시트: B2~B100에 `SM`, C2~C100에 `서면 본점` 미리 입력
> - 데이터 유효성을 해당 1개 코드로만 제한하면 다른 매장 코드 입력 불가

### 3.3 탭 2: 코드표 (IMPORTRANGE 연동용)

이 탭은 마스터 코드표에서 데이터를 가져옵니다 (섹션 7에서 설정).

### 3.4 탭 3: 🔖 입력 가이드

바리스타를 위한 인라인 가이드:

```
📋 주문 입력 가이드
━━━━━━━━━━━━━━━━━

✅ 반드시 지켜야 할 것
• 주문일: YYYY-MM-DD 형식 (예: 2026-02-15)
• 매장코드: 드롭다운에서 선택 (예: SM)
• 원두코드: 드롭다운에서 선택 (예: ETH-YRG)
• 수량: kg 단위 숫자만 (예: 5)
• 배송희망일: 오늘 + 2일 이상

❌ 하면 안 되는 것
• 컬럼 순서 변경/삭제/추가
• 1행(헤더) 수정
• 수량에 문자 입력 (예: "5박스" → ❌)
• 과거 날짜를 배송희망일에 입력

💡 팁
• 같은 원두 추가 주문: 새 행에 입력 (같은 날 여러 건 OK)
• 주문 수정: 해당 행 삭제 후 새로 입력
• 긴급 주문: 시트 입력 + 반드시 전화 연락
• 잘 모르겠으면: 로스터에게 연락하세요!
```

---

## 4. 데이터 유효성 검사 설정

각 컬럼에 아래 규칙을 설정합니다.

**설정 방법**: 해당 컬럼 전체 선택 → 데이터 → 데이터 유효성 → 기준 설정

| 컬럼 | 유효성 기준 | 설정 방법 |
|------|-----------|----------|
| A (주문일) | 유효한 날짜 | 기준: 날짜 / 유효한 날짜 |
| B (매장코드) | 목록 (코드표 참조) | 기준: 드롭다운(범위) → 코드표!A:A |
| D (원두코드) | 목록 (코드표 참조) | 기준: 드롭다운(범위) → 코드표!D:D |
| F (수량) | 양의 숫자 | 기준: 숫자 / > / 0 |
| G (배송희망일) | 유효한 날짜 | 기준: 날짜 / 유효한 날짜 |
| H (로스팅단계) | 목록 | 기준: 드롭다운 → 라이트, 미디엄, 다크 |
| I (분쇄여부) | 목록 | 기준: 드롭다운 → 홀빈, 분쇄 |
| J (긴급여부) | 목록 | 기준: 드롭다운 → Y, N |

> **💡 팁**: B(매장코드)와 D(원두코드)는 코드표 탭의 범위를 참조하세요.
> 마스터 코드표에서 IMPORTRANGE로 가져온 데이터를 드롭다운 소스로 사용합니다.

### 원두명 자동 완성 (선택사항)

원두코드(D열)를 선택하면 원두명(E열)이 자동으로 채워지게 하려면:

E2 셀에 다음 수식을 입력하고 아래로 드래그:
```
=IFERROR(VLOOKUP(D2, 코드표!D:E, 2, FALSE), "")
```

매장명(C열)도 같은 방식:
```
=IFERROR(VLOOKUP(B2, 코드표!A:B, 2, FALSE), "")
```

---

## 5. 헤더 보호 설정

**1행(헤더)을 편집 불가로 보호**합니다:

1. 메뉴: 데이터 → 시트 및 범위 보호
2. "시트" 선택 → "주문" 탭
3. "특정 셀 제외" 체크 → `A2:M1000` 입력 (2행 이후만 편집 가능)
4. 또는 "범위" 선택 → `주문!A1:M1` → 본인만 편집 가능

> 이렇게 하면 바리스타가 실수로 헤더를 수정하거나 컬럼 순서를 바꾸는 것을 방지합니다.

---

## 6. 매장에 복제 및 배포

### 6.1 마스터 템플릿 → 10개 복제

1. 마스터 시트 열기
2. 파일 → 사본 만들기
3. 이름 변경: `블랙업_주문_해운대`
4. 10개 매장 모두 반복

| # | 시트 이름 | 매장코드 |
|---|----------|---------|
| 1 | 블랙업_주문_로스터리 | RST |
| 2 | 블랙업_주문_서면본점 | SM |
| 3 | 블랙업_주문_해운대 | HD |
| 4 | 블랙업_주문_을숙도 | ESD |
| 5 | 블랙업_주문_롯데광복 | LGR |
| 6 | 블랙업_주문_양산 | YS |
| 7 | 블랙업_주문_거제수월 | GSW |
| 8 | 블랙업_주문_고현 | GH |
| 9 | 블랙업_주문_울산옥동 | UOD |
| 10 | 블랙업_주문_울산현대백화점 | UHD |

### 6.2 각 시트의 코드표 탭 IMPORTRANGE 연결

복제된 시트마다 코드표 탭의 IMPORTRANGE를 마스터 코드표 URL로 설정해야 합니다 (섹션 7 참조).

### 6.3 권한 설정

각 시트에 대해:

| 대상 | 권한 |
|------|------|
| 해당 매장 바리스타 | **편집자** |
| 에이전트 Google 계정 | **뷰어** |
| 로스터 | **소유자** (기본) |

### 6.4 Antigravity에 URL 등록

```
"전체 매장 URL 등록"
```

에이전트가 10개 매장을 순서대로 물어보면 각 시트 URL을 붙여넣으세요.

---

## 7. IMPORTRANGE 연동

### 7.1 왜 필요한가?

원두가 추가/변경될 때 마스터 코드표 1곳만 수정하면 10개 시트의 드롭다운이 자동으로 업데이트됩니다.

### 7.2 설정 방법

각 매장 시트의 **코드표 탭**에서:

**A1 셀** (매장코드 가져오기):
```
=IMPORTRANGE("https://docs.google.com/spreadsheets/d/MASTER_SHEET_ID", "매장코드!A:D")
```

**특정 셀** (원두코드 가져오기):
```
=IMPORTRANGE("https://docs.google.com/spreadsheets/d/MASTER_SHEET_ID", "원두코드!A:C")
```

**특정 셀** (옵션 가져오기):
```
=IMPORTRANGE("https://docs.google.com/spreadsheets/d/MASTER_SHEET_ID", "옵션!A:C")
```

> **⚠️ 최초 1회**: "이 스프레드시트에서 다른 스프레드시트의 데이터를 참조하도록 허용하시겠습니까?" → **허용** 클릭 필수

### 7.3 드롭다운에 IMPORTRANGE 데이터 연결

IMPORTRANGE로 가져온 코드표 데이터를 드롭다운의 소스 범위로 사용합니다:

1. 주문 탭의 B열(매장코드) 전체 선택
2. 데이터 → 데이터 유효성
3. 기준: 드롭다운(범위) → `코드표!A:A` (IMPORTRANGE로 가져온 매장코드 열)

원두코드(D열)도 같은 방식으로 `코드표!D:D`를 참조합니다.

---

## 8. 검증 체크리스트

### 마스터 코드표 시트

| # | 점검 항목 | 완료 |
|---|---------|------|
| 1 | 매장코드 탭에 10개 매장 입력 | ⬜ |
| 2 | 원두코드 탭에 3개 원두 입력 | ⬜ |
| 3 | 옵션 탭에 로스팅/분쇄/긴급 입력 | ⬜ |
| 4 | 로스터만 편집 가능 (공유 설정) | ⬜ |

### 매장 주문 시트 (매장별)

| # | 점검 항목 | 완료 |
|---|---------|------|
| 1 | '주문' 탭이 첫 번째 탭인가? | ⬜ |
| 2 | 13개 컬럼 헤더가 정확한가? | ⬜ |
| 3 | 헤더(1행)가 보호되어 있는가? | ⬜ |
| 4 | 매장코드 드롭다운이 동작하는가? | ⬜ |
| 5 | 원두코드 드롭다운이 동작하는가? | ⬜ |
| 6 | 수량에 숫자만 입력 가능한가? | ⬜ |
| 7 | 날짜 컬럼에 날짜만 입력 가능한가? | ⬜ |
| 8 | 로스팅/분쇄/긴급 드롭다운이 동작하는가? | ⬜ |
| 9 | IMPORTRANGE가 마스터 코드표에 연결되었는가? | ⬜ |
| 10 | '🔖 입력 가이드' 탭이 있는가? | ⬜ |
| 11 | 바리스타가 실제로 입력 가능한가? (권한) | ⬜ |
| 12 | 에이전트가 데이터를 읽을 수 있는가? (권한) | ⬜ |

### 전체 시스템

| # | 점검 항목 | 완료 |
|---|---------|------|
| 1 | 10개 시트 모두 생성됨 | ⬜ |
| 2 | 10개 URL 모두 settings.yaml에 등록됨 | ⬜ |
| 3 | 마스터 코드표에 원두 추가 → 매장 드롭다운 반영 확인 | ⬜ |
| 4 | "오늘 주문 정리해줘" 실행 → 리포트 생성 확인 | ⬜ |

---

## 9. 트러블슈팅 FAQ

| 증상 | 원인 | 해결 |
|------|------|------|
| IMPORTRANGE에 `#REF!` 표시 | 연결 미허용 | 셀 클릭 → "액세스 허용" 버튼 클릭 |
| 드롭다운이 비어있음 | 코드표 탭이 비어있음 | IMPORTRANGE 연결 확인, 마스터 시트 공유 확인 |
| "이 범위는 보호되어 있습니다" | 헤더 보호 활성 | 2행 이하에서 입력 (1행은 보호됨 — 정상) |
| 수량에 텍스트 입력 불가 | 데이터 유효성 작동 중 | 숫자만 입력 (예: `5`, 단위 없이) — 정상 |
| 날짜 형식 거부 | 날짜 유효성 작동 중 | YYYY-MM-DD 형식으로 입력 (예: 2026-02-15) |
| 시트 사본에 IMPORTRANGE 안 됨 | 사본마다 별도 허용 필요 | 각 사본에서 IMPORTRANGE 셀 클릭 → 허용 |
